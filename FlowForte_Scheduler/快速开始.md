# 🚀 FlowForte Scheduler - 快速开始指南

## 📌 你现在的状态

✅ Flow 主网账户已注册  
✅ 账户有 10 FLOW 代币  
✅ PersonalVault (EVM) 已部署  

---

## 🎯 5 步完成部署和测试

### **第 1 步: 配置环境变量（2 分钟）**

```bash
cd /Users/beastgirl/Desktop/flow-forte-contract/FlowForte_Scheduler

# 复制配置模板
cp .env.mainnet.example .env.mainnet

# 编辑配置文件
nano .env.mainnet  # 或使用你喜欢的编辑器
```

**填写这些必需的信息**：
```env
FLOW_MAINNET_ADDRESS=0x你的Flow地址
FLOW_MAINNET_PRIVATE_KEY=你的私钥
VAULT_ADDRESS=0x你的PersonalVault地址
```

**其他配置保持默认即可**（已经填好了）：
```env
WFLOW_ADDRESS=0xd3bF53DAC106A0290B0483EcBC89d40FcC961f3e
FACTORY_ADDRESS=0x486eDaD5bBbDC8eD5518172b48866cE747899D89
SWAP_ROUTER=0xf45AFe28fd5519d5f8C1d4787a4D5f724C0eFa4d
```

---

### **第 2 步: 检查配置（1 分钟）**

```bash
# 安装依赖（如果还没安装）
npm install

# 运行配置检查
npm run check
```

**应该看到**：
```
✅ 所有检查通过，可以开始部署!
```

**如果有错误**，按照提示修复。

---

### **第 3 步: 部署 Cadence 合约（2 分钟）**

```bash
# 检查账户余额
flow accounts get 0x你的地址 --network mainnet

# 部署合约到主网
flow project deploy --network mainnet
```

**成功输出**：
```
Deploying 2 contracts for accounts: mainnet-account

TradingScheduler -> 0x你的地址
ScheduledSwapHandler -> 0x你的地址

✅ All contracts deployed successfully
```

**重要**: 复制你的地址（就是合约地址）！

---

### **第 4 步: 更新配置（1 分钟）**

编辑 `.env.mainnet`，添加合约地址：

```env
TRADING_SCHEDULER_ADDRESS=0x你的地址
```

保存文件。

---

### **第 5 步: 运行测试（3 分钟）**

```bash
npm run test:mainnet
```

**测试流程**：
1. 显示配置信息
2. 警告这是主网操作（等待 5 秒）
3. 创建一个 5 分钟后执行的任务
4. 输出 FlowScan 链接

**成功输出**：
```
✅ 交易已提交!
交易 ID: abc123...

🔗 在 FlowScan 查看（主网）:
https://flowscan.io/transaction/abc123...

✅ 交易已确认!

📊 触发的事件:
  - TradingScheduler.TaskScheduled
```

---

## 🎉 完成！

现在你已经：
1. ✅ 部署了 Cadence 合约到 Flow 主网
2. ✅ 创建了一个定时任务
3. ✅ 在 FlowScan 上可以看到交易记录

---

## 📊 查看结果

### **在 FlowScan 查看**

访问测试输出的链接：
```
https://flowscan.io/transaction/{你的交易ID}
```

**应该看到**：
- ✅ Status: **Sealed** (已确认)
- ✅ Events: `TradingScheduler.TaskScheduled`
- ✅ Event Data:
  - `taskId`: 1
  - `vaultAddress`: 你的 Vault 地址
  - `tokenIn`: FLOW
  - `tokenOut`: WFLOW
  - `amountIn`: 100000000000000000 (0.1 FLOW)
  - `executeAt`: 时间戳
  - `recurring`: false

### **查看你的合约**

访问：
```
https://flowscan.io/address/0x你的地址
```

可以看到：
- 部署的合约
- 所有交易历史
- 触发的事件

---

## 🔍 等待任务执行（可选）

如果你想看到任务自动执行：

1. **等待 5 分钟**（测试任务设置的执行时间）

2. **再次访问 FlowScan**
   ```
   https://flowscan.io/address/0x你的地址
   ```

3. **查找 TaskExecuted 事件**
   - 如果看到这个事件，说明任务已自动执行
   - 这证明了 Scheduled Transactions 功能正常工作

---

## 🎬 黑客松演示准备

### **演示材料清单**

1. **FlowScan 链接**
   - 合约地址页面
   - TaskScheduled 交易
   - TaskExecuted 交易（如果已执行）

2. **代码演示**
   - 打开 `cadence/contracts/TradingScheduler.cdc`
   - 展示 Scheduled Transactions 集成
   - 展示跨 VM 调用代码

3. **架构图**
   - 参考 `黑客松部署指南.md` 中的架构图

4. **应用场景**
   - DCA 定期定额投资
   - 自动化交易策略

### **演示流程（5 分钟）**

**1. 介绍问题（1 分钟）**
- DeFi 自动化的痛点
- 现有方案的局限性

**2. 展示技术方案（2 分钟）**
- Scheduled Transactions: 完全去中心化的定时执行
- Flow Actions: 链上操作组合
- 跨 VM 调用: Cadence + EVM 协作

**3. 演示实际运行（2 分钟）**
- 打开 FlowScan，展示已部署的合约
- 展示 TaskScheduled 事件
- 如果有 TaskExecuted，展示自动执行结果
- 运行 `npm run test:mainnet` 现场创建任务

**4. 总结价值（30 秒）**
- 完全去中心化
- 用户体验好（无需在线）
- 可扩展性强

---

## 🆘 常见问题

### **Q: 如果没有 PersonalVault 地址怎么办？**

**临时方案**：使用测试地址
```env
VAULT_ADDRESS=0x0000000000000000000000000000000000000000
```

**正式方案**：创建 Vault
```bash
cd /Users/beastgirl/Desktop/flow-forte-contract/PersonalVault_Flow-EVM
npx hardhat run scripts/createVault.js --network flow
```

### **Q: 部署失败怎么办？**

**检查清单**：
1. 账户余额 ≥ 10 FLOW
2. `.env.mainnet` 配置正确
3. `flow.json` 中的地址和私钥匹配

**调试命令**：
```bash
flow accounts get 0x你的地址 --network mainnet
flow project deploy --network mainnet --log-level debug
```

### **Q: 测试失败怎么办？**

**常见原因**：
1. 合约未部署 → 先运行步骤 3
2. 配置错误 → 运行 `npm run check`
3. 网络问题 → 检查网络连接

### **Q: 如何验证任务会自动执行？**

**方法 1**: 等待 5 分钟，查看 FlowScan
- 查找 `TaskExecuted` 事件

**方法 2**: 查询任务状态（需要编写查询脚本）

---

## 📝 检查清单

### **部署前**
- [ ] `.env.mainnet` 已配置
- [ ] `npm run check` 通过
- [ ] 账户余额 ≥ 10 FLOW

### **部署后**
- [ ] 合约部署成功
- [ ] 合约地址已记录
- [ ] `.env.mainnet` 已更新

### **测试后**
- [ ] 测试运行成功
- [ ] FlowScan 可以看到交易
- [ ] TaskScheduled 事件已触发

### **演示准备**
- [ ] FlowScan 链接准备好
- [ ] 代码演示准备好
- [ ] 架构图准备好
- [ ] 应用场景说明准备好

---

## 🎯 成功标准

### **最小可行演示（MVP）**
1. ✅ 合约部署到主网
2. ✅ 可以创建任务
3. ✅ FlowScan 可见
4. ✅ 事件正确触发

### **完整演示**
1. ✅ 所有 MVP 要求
2. ✅ 任务自动执行
3. ✅ 端到端流程完整

---

## 📞 需要帮助？

**文档**：
- `黑客松部署指南.md` - 详细的项目说明
- `MAINNET_DEPLOYMENT.md` - 主网部署详细指南
- `README.md` - 项目概述

**命令**：
- `npm run check` - 检查配置
- `npm run test:mainnet` - 运行测试
- `flow accounts get <地址> --network mainnet` - 查看账户

**链接**：
- FlowScan: https://flowscan.io/
- Flow 文档: https://developers.flow.com/

---

## 🚀 现在开始！

```bash
# 1. 配置环境
cp .env.mainnet.example .env.mainnet
nano .env.mainnet

# 2. 检查配置
npm install
npm run check

# 3. 部署合约
flow project deploy --network mainnet

# 4. 更新配置
nano .env.mainnet  # 添加 TRADING_SCHEDULER_ADDRESS

# 5. 运行测试
npm run test:mainnet
```

**祝你黑客松顺利！** 🎉
